name: Sync to ModelScope

on:
  push:
    branches: [ main ]

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Push to ModelScope
        run: |
          # 1. 自动去除变量中可能存在的换行或空格
          MS_USER=$(echo "${{ secrets.MODELSCOPE_USERNAME }}" | tr -d '[:space:]')
          MS_PASS=$(echo "${{ secrets.MODELSCOPE_TOKEN }}" | tr -d '[:space:]')
          
          git config --global user.email "sync@example.com"
          git config --global user.name "GithubSync"
          
          # 2. 拼接 URL，注意项目名要完全一致
          REMOTE_URL="https://${MS_USER}:${MS_PASS}@www.modelscope.cn/studios/${MS_USER}/amazon-refund-analysis.git"
          
          # 3. 添加远程分支并推送
          git remote add modelscope "$REMOTE_URL"
          git push -f modelscope main
